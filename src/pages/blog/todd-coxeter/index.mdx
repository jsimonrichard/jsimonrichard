---
date: "2022-04-28"
title: "A Graphical Explanation of the Todd-Coxeter Algorithm"
tags: ["math", "algorithms"]
excerpt: "Coming soon..."
---
import { DemoGraph1 } from './components';

Using a group presentation is often the most compact and elegant way to define a group, and in some cases it is also the most natural [1]. However, it is in general quite difficult to analyze groups written in this form. In fact, it is impossible to create an algorithm that determines whether a group is finite, trivial, or abelian from its group presentation alone [1].

We can, however, analyze the cosets within these groups. The Todd-Coxeter Algorithm, which was originally created by J. A. Todd and H. S. M. Coxeter in the 1930s, is a clever and surprisingly simple algorithm that enumerates the cosets of a given subgroup using only the presentation of the parent group and the generators of the subgroup. In this post, I will endevour to explain the concepts behind this algorithm, the procedure itself, and the inner workings of an implementation of this algorithm.


## 1 Group Presentations

Before we continue, we need to nail down a working definition for group presentations. As taken from Derek Holt's lecture notes [1], if $\langle X \mid R \rangle$ is a presentation of the group $G$, then $G$ is the "largest" group generated by the elements of $X$ for which the relations in $R$ hold in $G$. For example, $\langle r,s \mid r^6 = s^2 = (rs)^2 = e \rangle$ is a presentation for the dihedral group $D_6$. Note that presentations are not necessarily unique.

The set $R$ may alternatively be defined to be a set of words following the form $g_1g_2...g_n$ with $g_i \in X$ or $g_i^{-1} \in X$ such that $g_1g_2...g_n=e$. For convenience's sake, we will use this definition from now on.


## 2 Group Actions

Group actions are also fundamental to the theory behind the Todd-Coxeter Algorithm.

Let $S$ be a set and let $G$ be a group. A (left) group action of $G$ on $S$ is a function $\alpha: G \times S \rightarrow S$ that meets the following requirements.

$$
\alpha(e, s) = s
$$

$$
\alpha(g, \alpha(h, s)) = \alpha(gh, s) \hspace{0.5cm} \forall g,h \in G
$$

If a group action of $G$ on $S$ exists, $G$ is said to act on $S$. If $G$ acts *transitively* on $S$, then the following is also true.

$$
\forall s_1,s_2 \in S, \exists g \in G \ni
\alpha(g, s_1) = s_2
$$

In otherwords, $S$ only has one orbit.

When working with group actions, $\alpha(g, s)$ is often simplified to $g \cdot s$ or $gs$. We will do this from now on.


## 3 Schreier Graphs

Now that we've defined both group presentations and group actions, we can define the Schreier graph, the fundamental data structure that underpins the Todd-Coxeter algorithm.

Let $G = \langle X \mid R \rangle$ and let $G$ act transitively on $S$. The Schreier graph for $S$ is a directed and labeled graph $\Gamma$ with $S$ as its vertex set and with edges labeled $g$ from $s$ to $gs$ $\forall s \in S$ and $\forall g \in X$.

#### Some Observations:
* Since group actions act bijectively on $S$ for a fixed $g$, each vertex has exactly one incomming and one outgoing edge for each label $g \in X$.
* A starting point $s \in S$ and a word $g_1g_2...g_k$ with $g_i \in X$ or $g_i^{-1} \in X$ defines a path in $\Gamma$
* Every word in $R$ corresponds with a loop in $\Gamma$

#### An Example

Let $G = \langle r, s \mid r^3, s^2, (rs)^2 \rangle$. That is, $G = \langle X \mid R \rangle$ with $X = \{r, s\}$ and $R = \{sss, rr, rsrs\}$. Let $S$ be a set of arbitrary regular triangles represented by the ordered triplets $(1,2,3)$, $(2,3,1)$, $(3,1,2)$, $(1,3,2)$, $(3,2,1)$, and $(2,1,3)$.

A possible solution for the Schreier graph of $S$ is as follows.

<DemoGraph1 />

Notice that the observations we just made hold for this example.


## 4 The Todd-Coxeter Algorithm

The Todd-Coxeter Algorithm takes two inputs.
* A presentation $G = \langle X \mid R \rangle$ with finite sets $X$ and $R$
* A finite set $Y$ that generates $H$, a subgroup of $G$

The output of the algorithm is the Schreier graph for the set of left cosets of $H$ in $G$, $G/H$, with the following group action.

$$
\alpha: G \times G/H \rightarrow G/H
$$

$$
\alpha(g_1, g_2H) = (g_1g_2)H
$$


### 4.1 The Procedure

From a theoretical standpoint, we start with the Schreier graph for the free group generated by $X$. It need not (and indeed cannot, since it is infinite) be entirely represented in memory. Then, we follow the steps below.

1. Label the vertex corresponding to the coset $H$ with the label $1$ (this *is* represented in memory).

2. For each word $h \in H$, start at vertex $1$ and follow the path defined by $h$. Give the vertices along this path new labels and *identify* the vertex at the end with vertex $1$.

> To identify two vertices, remove the one with the higher label and then merge its edges with the edges of the other vertex. If a conflict between edges with the same label occurs, identify the vertices at the other end those edges as well.

3. For each vertex that is labeled or that will be labeled (including the ones that will be labeled during this step), define a path starting at that vertex for each word in $R$ (so, if $S$ is the set of all vertices that will eventually be labeled, there should be $|S|\cdot|R|$ paths in total). Then, for each path $p$, label the vertices along $p$ and identify starting point of $p$ with the endpoint of $p$.

If and when this final step terminates, we will be left with a Schreier graph for $G/H$ that is completely labeled.


## 5 Implementation

Coming soon...

## Resources and Bibliography

1. https://warwick.ac.uk/fac/sci/maths/people/staff/fbouyer/presentation_of_group.pdf
2. A practical method for enumerating cosets of a finite abstract group, Todd et al. (pdf)
3. https://math.berkeley.edu/~kmill/notes/todd_coxeter.html